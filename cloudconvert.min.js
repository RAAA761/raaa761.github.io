"use strict";function CloudConvert(){this.go=function(r){function n(){$.ajax({type:"GET",url:e,crossDomain:!0,contentType:"application/json",dataType:"json",success:function(o){o.error?r.apiError(o):("finished"!==o.step||i||(i=!0,clearInterval(a),r.finished(o)),r.progressUpdated(o.percent,o.step))},error:function(o){i||(i=!0,clearInterval(a),r.error(o))}})}function t(o){$.ajax({type:"POST",url:o,crossDomain:!0,contentType:"application/json",data:JSON.stringify({input:"upload",outputformat:r.outputformat,save:!0}),dataType:"json",success:function(o){o.error?r.apiError(o):function(o){var t=new FormData;t.append("file",r.file),$.ajax({type:"POST",url:o,crossDomain:!0,processData:!1,contentType:!1,data:t,dataType:"json",xhr:function(){var o=null;return(o=window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLHTTP"):new window.XMLHttpRequest).upload.addEventListener("progress",function(o){if(o.lengthComputable){var t=Math.round(100*o.loaded/o.total);r.uploadProgress(t)}},!1),o},success:function(o){o.error?r.apiError(o):(r.uploadComplete(),a=window.setInterval(n,1e3))},error:r.error})}("https:"+o.upload.url)},error:r.error})}var e="",a={},i=!1;$.ajax({type:"POST",url:location.protocol+"//"+window.location.hostname+"/cloud_convert/process.php",contentType:"application/json",crossDomain:!0,data:JSON.stringify({inputformat:r.inputformat,outputformat:r.outputformat}),dataType:"json",success:function(o){o.error?r.apiError(o):(void 0!==r.startProcessInfo&&r.startProcessInfo(o),e="https:"+o.url,"file"==r.conversionType?t(e):"link"==r.conversionType&&function(o){$.ajax({type:"POST",url:o,crossDomain:!0,contentType:"application/json",data:JSON.stringify({input:"download",file:r.file,filename:r.title+"."+r.inputformat,outputformat:r.outputformat,save:!0}),dataType:"json",success:function(o){o.error?r.apiError(o):a=window.setInterval(n,1e3)},error:r.error})}(e))},error:r.error})};this.cancelTask=function(o){!function(o,t){if(window.navigator.sendBeacon)return window.navigator.sendBeacon(o,t);var r=new XMLHttpRequest;r.open("POST",o,!1),r.send(t)}(location.protocol+"//"+window.location.hostname+"/cloud_convert/cancel_process.php",JSON.stringify(o))}}